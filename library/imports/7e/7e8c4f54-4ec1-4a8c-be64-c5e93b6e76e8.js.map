{"version":3,"sources":["assets/scripts/Bubble.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,4EAA4E;AAC5E,mBAAmB;AACnB,sFAAsF;AACtF,8BAA8B;AAC9B,sFAAsF;;;;;;;;;;;;;;;;;;;;;AAEtF,mEAA4E;AAC5E,uDAAsD;AAEhD,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAoC,0BAAY;IAAhD;QAAA,qEAmFC;QAhFU,mBAAa,GAAoB,IAAI,mCAAe,EAAE,CAAC;QAG9D,kBAAY,GAAwB,IAAI,CAAC;QAEzC,UAAI,GAAe,YAAY,CAAA;;IA2EnC,CAAC;IAnEG,sBAAK,GAAL;QACI,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAC9D,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IACtE,CAAC;IAGD,yBAAQ,GAAR,UAAS,IAAiB;QACtB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAA;QAC1C,IAAG,CAAC,IAAI,EAAE;YACN,IAAM,WAAW,GAAG,6BAAa,EAAE,CAAA;YACnC,IAAI,CAAC,IAAI,GAAG,WAAW,CAAA;YACvB,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAA;YAC9C,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,MAAM,CAAA;YAChC,OAAM;SACT;QACD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;QAChB,IAAI,CAAC,MAAM,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAA;IACtD,CAAC;IAED,yBAAQ,GAAR,UAAS,IAAY;QACjB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;QAChB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,CAAC,CAAA;IAC9C,CAAC;IAED,0BAAS,GAAT,UAAU,KAAc;QACpB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;IACtB,CAAC;IAED,wBAAO,GAAP;QACI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC/C,CAAC;IAED,0BAAS,GAAT;QACI,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;QACpD,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;QACxB,IAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC7C,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;IAC7B,CAAC;IAED,kCAAiB,GAAjB,UAAkB,QAAiB;QAC/B,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAA;IACnC,CAAC;IAED,+BAAc,GAAd,UAAe,QAAiB,EAAE,KAAa;QAA/C,iBAKC;QAJG,IAAM,IAAI,GAAG,UAAU,CAAC;YACpB,IAAM,IAAI,GAAG,EAAE,CAAC,MAAM,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;YACtC,KAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAC9B,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,CAAA;IACnB,CAAC;IAED,8BAAa,GAAb,UAAc,KAAa;QAA3B,iBAeC;QAdG,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;QAC5B,IAAM,KAAK,GAAG,UAAU,CAAC;YACrB,IAAG,KAAK,GAAG,CAAC,EAAE;gBACV,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,KAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;aACvD;YACD,IAAM,IAAI,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;YAC3B,YAAY,CAAC,KAAK,CAAC,CAAA;YACnB,IAAM,cAAc,GAAG,UAAU,CAAC;gBAC9B,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAA;gBACnB,YAAY,CAAC,cAAc,CAAC,CAAA;YAChC,CAAC,EAAE,GAAG,CAAC,CAAA;QACX,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,CAAA;IAEnB,CAAC;IA9ED;QADC,QAAQ,CAAC,mCAAe,CAAC;iDACoC;IAG9D;QADC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;gDACkB;IANxB,MAAM;QAD1B,OAAO;OACa,MAAM,CAmF1B;IAAD,aAAC;CAnFD,AAmFC,CAnFmC,EAAE,CAAC,SAAS,GAmF/C;kBAnFoB,MAAM","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport { BubbleSpriteSet, BubbleType } from \"./constants/bubbleSpriteFrame\";\nimport { getRandomType } from \"./utils/getRandomType\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Bubble extends cc.Component {\n\n    @property(BubbleSpriteSet)\n    public bubbleSprites: BubbleSpriteSet = new BubbleSpriteSet();\n\n    @property(cc.AudioClip)\n    destroySound: cc.AudioClip | null = null;\n\n    type: BubbleType = 'block_blue'\n\n    sprite: cc.Sprite\n\n    size: number\n\n    coord: cc.Vec2\n\n    start() {\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onClick, this);\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onKeyDown, this);\n    }\n\n\n    initType(type?: BubbleType) {\n        this.sprite = this.getComponent(cc.Sprite)\n        if(!type) {\n            const sprite_name = getRandomType()\n            this.type = sprite_name\n            const sprite = this.bubbleSprites[sprite_name]\n            this.sprite.spriteFrame = sprite\n            return\n        }\n        this.type = type\n        this.sprite.spriteFrame = this.bubbleSprites[type]\n    }\n\n    initSize(size: number) {\n        this.size = size\n        this.node.setScale(size / 100, size / 100)\n    }\n\n    initCoord(coord: cc.Vec2) {\n        this.coord = coord\n    }\n\n    onClick() {\n        this.node.emit('bubble-click', this.coord);\n    }\n\n    onKeyDown() {\n        cc.audioEngine.playEffect(this.destroySound, false);\n        console.log('KEY_DOWN');\n        const anim = this.getComponent(cc.Animation);\n        anim.play('bubble_touch')\n    }\n\n    setBubblePosition(position: cc.Vec2) {\n        this.node.setPosition(position)\n    }\n\n    moveToPosition(position: cc.Vec2, delay: number) {\n        const time = setTimeout(() => {\n            const move = cc.moveTo(0.5, position);\n            this.node.runAction(move);\n        }, delay * 100)\n    }\n\n    bubbleDestroy(delay: number) {\n        console.log('delay', delay);\n        const timer = setTimeout(() => {\n            if(delay > 0) {\n                cc.audioEngine.playEffect(this.destroySound, false);\n            }\n            const anim = this.getComponent(cc.Animation);\n            anim.play('bubble_destroy')\n            clearTimeout(timer)\n            const timerToDestroy = setTimeout(() => {\n                this.node.destroy()\n                clearTimeout(timerToDestroy)\n            }, 200)\n        }, delay * 100)\n        \n    }\n\n}\n"]}